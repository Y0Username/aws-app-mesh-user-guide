<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE chapter PUBLIC "-//OASIS//DTD DocBook XML V4.5//EN" "file://zonbook/docbookx.dtd"
[
    <!ENTITY % xinclude SYSTEM "file://AWSShared/common/xinclude.mod">
    %xinclude;
    <!ENTITY % phrases-shared SYSTEM "file://AWSShared/common/phrases-shared.ent">
    %phrases-shared;
    <!ENTITY % phrases-appmesh SYSTEM "../shared/phrases-app-mesh.ent"> 
    %phrases-appmesh;
]>
<section id="cloudwatch">
    <info>
        <title id="cloudwatch.title">&CW; for &MESH;</title>
        <titleabbrev>&CW;</titleabbrev>
    </info>
    <formalpara>
        <title>Emitting Envoy stats to &CW; from &EKS;</title>
        <para>You can install the &CW; Agent to your cluster and configure it to collect a
            subset of metrics from your proxies. If you do not already have an &EKS; cluster,
            then you can create one with the steps in <ulink
                url="https://github.com/aws/aws-app-mesh-examples/tree/master/walkthroughs/eks"
                >Walkthrough: &MESH; with &EKS;</ulink> on GitHub. You can install a sample
            application onto the cluster by following the same walkthrough.</para>
    </formalpara>
    <para>To set the appropriate IAM permissions for your cluster and install the agent, follow
        the steps in <ulink type="documentation"
            url="AmazonCloudWatch/latest/monitoring/ContainerInsights-Prometheus-Setup.html"
            >Install the CloudWatch Agent with Prometheus Metrics Collection</ulink>. The
        default installation contains a Prometheus scrape configuration which pulls a useful
        subset of Envoy stats. For more information, see <ulink type="documentation"
            url="AmazonCloudWatch/latest/monitoring/ContainerInsights-Prometheus-metrics.html#ContainerInsights-Prometheus-metrics-appmesh"
            >Prometheus Metrics for App Mesh</ulink>.</para>
    <para>To create an &MESH; custom &CW; dashboard configured to display the metrics that the
        agent is collecting, follow the steps in the <ulink
            url="https://docs.aws.amazon.com/AmazonCloudWatch/latest/monitoring/ContainerInsights-Prometheus-viewmetrics.html"
            >Viewing Your Prometheus Metrics</ulink> tutorial. Your graphs will begin to
        populate with the corresponding metrics as traffic enters the &MESH; application.</para>
    <section id="cloudwatch-sample">
        <info>
            <title id="cloudwatch-sample.title">&CW; Example</title>
        </info>
        <para>You can find a sample configuration of &CW; in our <ulink
                url="https://github.com/aws-samples/aws-app-mesh-cloudwatch-agent">&AWS; Samples
                repository</ulink>.</para>
    </section>
    <section id="cloudwatch-walkthrough">
        <info>
            <title id="cloudwatch-walkthrough.title">Walkthroughs for using the &CW;</title>
        </info>
        <itemizedlist>
            <listitem>
                <para><ulink url="https://www.appmeshworkshop.com/monitoring/">Add monitoring and
                        logging capabilities</ulink> in our <ulink
                        url="https://www.appmeshworkshop.com/introduction/">&MESH;
                    workshop</ulink>.</para>
            </listitem>
            <listitem>
                <para><ulink
                        url="https://github.com/aws/aws-app-mesh-examples/blob/master/walkthroughs/eks/o11y-cloudwatch.md"
                        >App Mesh with EKSâ€”Observability: CloudWatch</ulink></para>
            </listitem>
        </itemizedlist>
    </section>
</section>
