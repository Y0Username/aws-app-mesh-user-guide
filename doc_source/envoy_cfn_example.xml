<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE chapter PUBLIC "-//OASIS//DTD DocBook XML V4.5//EN" "file://zonbook/docbookx.dtd"
[
    <!ENTITY % xinclude SYSTEM "file://AWSShared/common/xinclude.mod">
    %xinclude;
    <!ENTITY % phrases-shared SYSTEM "file://AWSShared/common/phrases-shared.ent">
    %phrases-shared;
    <!ENTITY % phrases-appmesh SYSTEM "../shared/phrases-app-mesh.ent"> 
    %phrases-appmesh;
]>
<example>
  <title>&CFN; for &ECS; task definition</title>
  <programlisting language="yaml">
- Name: "envoy"
  Image: "&envoy-image;"
  Essential: true
  Environment:
    - Name: APPMESH_RESOURCE_ARN
      Value: "mesh/<replaceable>meshName</replaceable>/virtualNode/<replaceable>virtualNodeName</replaceable>"
    - Name: ENVOY_LOG_LEVEL
      Value: info
  User: "1337"
- Name: "proxyinit"
  Image: "&router-image;"
  Essential: false
  LinuxParameters:
    Capabilities:
      Add:
        - "NET_ADMIN"
  Environment:
    - Name: "APPMESH_START_ENABLED"
      Value: "1"
    - Name: "APPMESH_IGNORE_UID"
      Value: "1337"
    - Name: "APPMESH_ENVOY_INGRESS_PORT"
      Value: "15000"
    - Name: "APPMESH_ENVOY_EGRESS_PORT"
      Value: "15001"
    - Name: "APPMESH_APP_PORTS"
      Value: "<replaceable>application_port_list</replaceable>"
    - Name: "APPMESH_EGRESS_IGNORED_IP"
      Value: "169.254.169.254,169.254.170.2"
    </programlisting>
</example>
